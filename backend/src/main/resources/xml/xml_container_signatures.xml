<?xml version="1.0" encoding="UTF-8"?>
<ContainerSignatureMapping schemaVersion="1.0" signatureVersion="27" xmlns:th="http://www.thymeleaf.org">
    <ContainerSignatures><th:block th:each="contSig : ${containerSignatures}">
        <ContainerSignature th:Id="${contSig.ID}" th:ContainerType="${contSig.containerTypeName}">
            <Description th:text="${contSig.name}">Microsoft Word 6.0/95 OLE2</Description>
            <Files><th:block th:each="file: ${contSig.files}">
                <File>
                    <Path th:text="${file.path}">CompObj</Path><th:block th:unless="${#lists.isEmpty(file.byteSequences)}">
                    <BinarySignatures>
                        <InternalSignatureCollection>
                            <InternalSignature th:each="bs : ${file.byteSequences}" th:ID="${bs.containerID}">
                                <th:block th:with="conv=${bs.toJAXBType(true)}"><ByteSequence th:unless="${conv == null}" Reference="BOFoffset"><th:block th:each="ss : ${conv.subSequence}">
                                    <SubSequence th:Position="${ss.position}" th:SubSeqMaxOffset="${ss.subSeqMinOffset}" th:SubSeqMinOffset="${ss.subSeqMaxOffset}" th:MinFragLength="${ss.minFragLength}"><th:block th:if="${ss.sequence}">
                                        <Sequence th:utext="${@templateUtils.customEscape(ss.sequence)}">00000000</Sequence></th:block><th:block th:if="${ss.defaultShift != null}">
                                        <DefaultShift th:text="${ss.defaultShift}">0</DefaultShift></th:block><th:block th:unless="${#lists.isEmpty(ss.shiftOrLeftFragmentOrRightFragment)}" th:each="frag : ${ss.shiftOrLeftFragmentOrRightFragment}">
                                        <th:block th:utext="${@templateUtils.jaxb(frag)}"/></th:block>
                                    </SubSequence></th:block>
                                </ByteSequence></th:block>
                            </InternalSignature>
                        </InternalSignatureCollection>
                    </BinarySignatures></th:block>
                </File></th:block>
            </Files>
        </ContainerSignature></th:block>
    </ContainerSignatures>
    <FileFormatMappings><th:block th:each="f : ${formats}"><th:block th:unless="${#lists.isEmpty(f.containerSignatures)}">
        <FileFormatMapping th:each="cSig : ${f.containerSignatures}" th:signatureId="${cSig.ID}" th:Puid="${f.formattedPuid}"/></th:block></th:block>
    </FileFormatMappings>
    <TriggerPuids><th:block th:each="ct : ${containerTypes}"><th:block th:unless="${#lists.isEmpty(ct.fileFormats)}">
        <TriggerPuid th:each="f : ${ct.fileFormats}" th:ContainerType="${ct.name}" th:Puid="${f.formattedPuid}"/></th:block></th:block>
    </TriggerPuids>
</ContainerSignatureMapping>